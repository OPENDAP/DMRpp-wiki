<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.26">
<meta name="author" content="OPeNDAP, Inc.">
<title>Building and Testing DMR++ Documents</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.square{list-style-type:square}
ul.circle ul:not([class]),ul.disc ul:not([class]),ul.square ul:not([class]){list-style:inherit}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child{border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:first-child,.sidebarblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child,.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock pre>code{display:block}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active,#footnotes .footnote a:first-of-type:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,td.hdlist1,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
/*! Stylesheet for CodeRay to loosely match GitHub themes | MIT License */
pre.CodeRay{background:#f7f7f8}
.CodeRay .line-numbers{border-right:1px solid;opacity:.35;padding:0 .5em 0 0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
.CodeRay span.line-numbers{display:inline-block;margin-right:.75em}
.CodeRay .line-numbers strong{color:#000}
table.CodeRay{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.CodeRay td{vertical-align:top;line-height:inherit}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.code{padding:0 0 0 .75em}
.CodeRay .debug{color:#fff!important;background:navy!important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:navy}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:teal}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:teal}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#000}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:teal}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword{color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:teal}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
<!--
###############################################################################
# Generate a nice collapsible TOC
#
# Thanks to StackOverflow user "rec",
#     https://stackoverflow.com/users/2511197/rec
# For this answer:
#     https://stackoverflow.com/questions/34481638/how-to-use-tocify-with-asciidoctor-for-a-dynamic-toc
# Which seems to be working nicely for us.
#
# The OPeNDAP Team - 03/22/2025
###############################################################################
-->

<!-- Generate a nice TOC -->
<script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
<script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
<script>
    /*! jquery.tocify - v1.9.0 - 2013-10-01
     * http://gregfranko.com/jquery.tocify.js/
     * Copyright (c) 2013 Greg Franko; Licensed MIT
     */
    (function (e) {
        "use strict"; e(window.jQuery, window, document)
    })(function (e, t, s) {
        "use strict"; var i = "tocify", o = "tocify-focus", n = "tocify-hover", a = "tocify-hide", l = "tocify-header", h = "." + l, r = "tocify-subheader", d = "." + r, c = "tocify-item", f = "." + c, u = "tocify-extend-page", p = "." + u; e.widget("toc.tocify", {
            version: "1.9.0", options: {
                context: "body", ignoreSelector: null, selectors: "h1, h2, h3", showAndHide: ! 0, showEffect: "slideDown", showEffectSpeed: "medium", hideEffect: "slideUp", hideEffectSpeed: "medium", smoothScroll: ! 0, smoothScrollSpeed: "medium", scrollTo: 0, showAndHideOnScroll: ! 0, highlightOnScroll: ! 0, highlightOffset: 40, theme: "bootstrap", extendPage: ! 0, extendPageOffset: 100, history: ! 0, scrollHistory: ! 1, hashGenerator: "compact", highlightDefault: ! 0
            },
            _create: function () {
                var s = this; s.extendPageScroll = ! 0, s.items =[], s._generateToc(), s._addCSSClasses(), s.webkit = function () {
                    for (var e in t) if (e && -1 !== e.toLowerCase().indexOf("webkit")) return ! 0; return ! 1
                }
                (), s._setEventHandlers(), e(t).load(function () {
                    s._setActiveElement(! 0), e("html, body").promise().done(function () {
                        setTimeout(function () {
                                s.extendPageScroll = ! 1
                            },
                            0)
                    })
                })
            },
            _generateToc: function () {
                var t, s, o = this, n = o.options.ignoreSelector; return t = -1 !== this.options.selectors.indexOf(",") ? e(this.options.context).find(this.options.selectors.replace(/ /g, "").substr(0, this.options.selectors.indexOf(","))): e(this.options.context).find(this.options.selectors.replace(/ /g, "")), t.length ?(o.element.addClass(i), t.each(function (t) {
                    e(this).is(n) ||(s = e("<ul/>", {
                        id: l + t, "class": l
                    }).append(o._nestElements(e(this), t)), o.element.append(s), e(this).nextUntil(this.nodeName.toLowerCase()).each(function () {
                        0 === e(this).find(o.options.selectors).length ? e(this).filter(o.options.selectors).each(function () {
                            e(this).is(n) || o._appendSubheaders.call(this, o, s)
                        }): e(this).find(o.options.selectors).each(function () {
                            e(this).is(n) || o._appendSubheaders.call(this, o, s)
                        })
                    }))
                }), undefined):(o.element.addClass(a), undefined)
            },
            _setActiveElement: function (e) {
                var s = this, i = t.location.hash.substring(1), o = s.element.find('li[data-unique="' + i + '"]');
                return i.length ?(s.element.find("." + s.focusClass).removeClass(s.focusClass), o.addClass(s.focusClass), s.options.showAndHide && o.click()):(s.element.find("." + s.focusClass).removeClass(s.focusClass), ! i.length && e && s.options.highlightDefault && s.element.find(f).first().addClass(s.focusClass)), s
            },
            _nestElements: function (t, s) {
                var i, o, n; return i = e.grep(this.items, function (e) {
                    return e === t.text()
                }), i.length ? this.items.push(t.text() + s): this.items.push(t.text()), n = this._generateHashValue(i, t, s), o = e("<li/>", {
                    "class": c, "data-unique": n
                }).append(e("<a/>", {
                    text: t.text()
                })), t.before(e("<div/>", {
                    name: n, "data-unique": n
                })), o
            },
            _generateHashValue: function (e, t, s) {
                var i = "", o = this.options.hashGenerator; if ("pretty" === o) {
                    for (i = t.text().toLowerCase().replace(/\s/g, "-");
                         i.indexOf("--") > -1;) i = i.replace(/--/g, "-");
                    for (; i.indexOf(":-") > -1;) i = i.replace(/:-/g, "-")
                } else i = "function" == typeof o ? o(t.text(), t): t.text().replace(/\s/g, "");
                return e.length &&(i += "" + s), i
            },
            _appendSubheaders: function (t, s) {
                var i = e(this).index(t.options.selectors), o = e(t.options.selectors).eq(i -1), n = + e(this).prop("tagName").charAt(1), a = + o.prop("tagName").charAt(1);
                a > n ? t.element.find(d + "[data-tag=" + n + "]").last().append(t._nestElements(e(this), i)): n === a ? s.find(f).last().after(t._nestElements(e(this), i)): s.find(f).last().after(e("<ul/>", {
                    "class": r, "data-tag": n
                })).next(d).append(t._nestElements(e(this), i))
            },
            _setEventHandlers: function () {
                var i = this; this.element.on("click.tocify", "li", function () {
                    if (i.options.history &&(t.location.hash = e(this).attr("data-unique")), i.element.find("." + i.focusClass).removeClass(i.focusClass), e(this).addClass(i.focusClass), i.options.showAndHide) {
                        var s = e('li[data-unique="' + e(this).attr("data-unique") + '"]');
                        i._triggerShow(s)
                    }
                    i._scrollTo(e(this))
                }), this.element.find("li").on({
                    "mouseenter.tocify": function () {
                        e(this).addClass(i.hoverClass), e(this).css("cursor", "pointer")
                    },
                    "mouseleave.tocify": function () {
                        "bootstrap" !== i.options.theme && e(this).removeClass(i.hoverClass)
                    }
                }),(i.options.extendPage || i.options.highlightOnScroll || i.options.scrollHistory || i.options.showAndHideOnScroll) && e(t).on("scroll.tocify", function () {
                    e("html, body").promise().done(function () {
                        var o, n, a, l, h = e(t).scrollTop(), r = e(t).height(), d = e(s).height(), c = e("body")[0].scrollHeight; if (i.options.extendPage &&(i.webkit && h >= c - r - i.options.extendPageOffset || ! i.webkit && r + h > d - i.options.extendPageOffset) && ! e(p).length) {
                            if (n = e('div[data-unique="' + e(f).last().attr("data-unique") + '"]'), ! n.length) return; a = n.offset().top, e(i.options.context).append(e("<div />", {
                                "class": u, height: Math.abs(a - h) + "px", "data-unique": u
                            })), i.extendPageScroll &&(l = i.element.find("li.active"), i._scrollTo(e('div[data-unique="' + l.attr("data-unique") + '"]')))
                        }
                        setTimeout(function () {
                                var s, n = null, a = null, l = e(i.options.context).find("div[data-unique]");
                                l.each(function (t) {
                                    var s = Math.abs((e(this).next().length ? e(this).next(): e(this)).offset().top - h - i.options.highlightOffset);
                                    return null == n || n > s ?(n = s, a = t, undefined): ! 1
                                }), s = e(l[a]).attr("data-unique"), o = e('li[data-unique="' + s + '"]'), i.options.highlightOnScroll && o.length &&(i.element.find("." + i.focusClass).removeClass(i.focusClass), o.addClass(i.focusClass)), i.options.scrollHistory && t.location.hash !== "#" + s && t.location.replace("#" + s), i.options.showAndHideOnScroll && i.options.showAndHide && i._triggerShow(o, ! 0)
                            },
                            0)
                    })
                })
            },
            show: function (t) {
                var s = this; if (! t.is(":visible")) switch (t.find(d).length || t.parent().is(h) || t.parent().is(":visible") ? t.children(d).length || t.parent().is(h) ||(t = t.closest(d)): t = t.parents(d).add(t), s.options.showEffect) {
                    case "none": t.show();
                        break; case "show": t.show(s.options.showEffectSpeed);
                        break; case "slideDown": t.slideDown(s.options.showEffectSpeed);
                        break; case "fadeIn": t.fadeIn(s.options.showEffectSpeed);
                        break; default: t.show()
                }
                return t.parent().is(h) ? s.hide(e(d).not(t)): s.hide(e(d).not(t.closest(h).find(d).not(t.siblings()))), s
            },
            hide: function (e) {
                var t = this; switch (t.options.hideEffect) {
                    case "none": e.hide();
                        break; case "hide": e.hide(t.options.hideEffectSpeed);
                        break; case "slideUp": e.slideUp(t.options.hideEffectSpeed);
                        break; case "fadeOut": e.fadeOut(t.options.hideEffectSpeed);
                        break; default: e.hide()
                }
                return t
            },
            _triggerShow: function (e, t) {
                var s = this; return e.parent().is(h) || e.next().is(d) ? s.show(e.next(d), t): e.parent().is(d) && s.show(e.parent(), t), s
            },
            _addCSSClasses: function () {
                return "jqueryui" === this.options.theme ?(this.focusClass = "ui-state-default", this.hoverClass = "ui-state-hover", this.element.addClass("ui-widget").find(".toc-title").addClass("ui-widget-header").end().find("li").addClass("ui-widget-content")): "bootstrap" === this.options.theme ?(this.element.find(h + "," + d).addClass("nav nav-list"), this.focusClass = "active"):(this.focusClass = o, this.hoverClass = n), this
            },
            setOption: function () {
                e.Widget.prototype._setOption.apply(this, arguments)
            },
            setOptions: function () {
                e.Widget.prototype._setOptions.apply(this, arguments)
            },
            _scrollTo: function (t) {
                var s = this, i = s.options.smoothScroll || 0, o = s.options.scrollTo, n = e('div[data-unique="' + t.attr("data-unique") + '"]');
                return n.length ?(e("html, body").promise().done(function () {
                    e("html, body").animate({
                        scrollTop: n.offset().top -(e.isFunction(o) ? o.call(): o) + "px"
                    }, {
                        duration: i
                    })
                }), s): s
            }
        })
    });
</script>

<!-- We do not need the tocify CSS because the asciidoc CSS already provides most of what we neeed -->

<style>
    .tocify-header {
        font-style: italic;
    }

    .tocify-subheader {
        font-style: normal;
        font-size: 90%;
    }

    .tocify ul {
        margin: 0;
    }

    .tocify-focus {
        color: #7a2518;
        background-color: rgba(0, 0, 0, 0.1);
    }

    .tocify-focus > a {
        color: #7a2518;
    }
</style>

<script type="text/javascript">
    $(function () {
        // Add a new container for the tocify toc into the existing toc so we can re-use its
        // styling
        $("#toc").append("<div id='generated-toc'></div>");
        $("#generated-toc").tocify({
            extendPage: true,
            context: "#content",
            highlightOnScroll: true,
            hideEffect: "slideUp",
            // Use the IDs that asciidoc already provides so that TOC links and intra-document
            // links are the same. Anything else might confuse users when they create bookmarks.
            hashGenerator: function(text, element) {
                return $(element).attr("id");
            },
            // Smooth scrolling doesn't work properly if we use the asciidoc IDs
            smoothScroll: false,
            // Set to 'none' to use the tocify classes
            theme: "none",
            // Handle book (may contain h1) and article (only h2 deeper)
            selectors: $( "#content" ).has( "h1" ).size() > 0 ? "h1,h2,h3,h4,h5" : "h2,h3,h4,h5",
            ignoreSelector: ".discrete"
        });

        // Switch between static asciidoc toc and dynamic tocify toc based on browser size
        // This is set to match the media selectors in the asciidoc CSS
        // Without this, we keep the dynamic toc even if it is moved from the side to preamble
        // position which will cause odd scrolling behavior
        var handleTocOnResize = function() {
            if ($(document).width() < 768) {
                $("#generated-toc").hide();
                $(".sectlevel0").show();
                $(".sectlevel1").show();
            }
            else {
                $("#generated-toc").show();
                $(".sectlevel0").hide();
                $(".sectlevel1").hide();
            }
        }

        $(window).resize(handleTocOnResize);
        handleTocOnResize();
    });
</script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-J5L38PDYTT"></script>
<script>
window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag("js", new Date());
gtag("config", "G-J5L38PDYTT");
</script>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>Building and Testing DMR++ Documents</h1>
<div class="details">
<span id="author" class="author">OPeNDAP, Inc.</span><br>
<span id="revdate">2025-10-31</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_intended_audience">1. Intended Audience</a></li>
<li><a href="#_introduction">2. Introduction</a></li>
<li><a href="#_supported_data_formats">3. Supported Data Formats</a>
<ul class="sectlevel2">
<li><a href="#_the_gory_details">3.1. The Gory Details</a>
<ul class="sectlevel3">
<li><a href="#_is_my_netcdf_file_a_version_3_or_version_4_file">3.1.1. Is My NetCDF File A Version <em>3</em> or Version <em>4</em> File?</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#sec-build-them">4. How to Build DMR++ reference files</a>
<ul class="sectlevel2">
<li><a href="#_assumptions">4.1. Assumptions</a></li>
<li><a href="#sec-examples">4.2. Examples</a></li>
<li><a href="#sec-data-source-url">4.3. How DMR++ References the Matching Data File</a></li>
<li><a href="#sec-sidecar-template">4.4. How DMR++ References a Sidecar File for Geo-referencing Data</a></li>
<li><a href="#sec-cmd-exp">4.5. Explanation of the <code>gen_dmrpp_side_car</code> Command Options</a></li>
<li><a href="#_explanation_of_the_docker_run_command_options">4.6. Explanation of the <code>docker run</code> Command Options</a></li>
</ul>
</li>
<li><a href="#sec-test-them">5. Testing DMR++ Containers Using the Builtin Hyrax Server</a></li>
<li><a href="#_serving_data_using_dmr_files">6. Serving Data Using DMR++ Files</a>
<ul class="sectlevel2">
<li><a href="#_using_dmr_with_https_urls">6.1. Using DMR++ with HTTP/S URLs</a></li>
<li><a href="#_using_dmr_with_file_urls">6.2. Using DMR++ with file URLs</a></li>
<li><a href="#_using_dmr_with_the_template_string_nasa">6.3. Using DMR++ with the template string (NASA).</a></li>
</ul>
</li>
<li><a href="#_useful_docker_commands">Appenix A: Useful Docker Commands</a></li>
<li><a href="#_building_dmr_files_for_hdf4_and_hdf4_eos2_advanced">Appenix B: Building DMR++ files for HDF4 and HDF4-EOS2 (advanced)</a>
<ul class="sectlevel2">
<li><a href="#_using_get_dmrpp_h4">B.1. Using get_dmrpp_h4</a>
<ul class="sectlevel3">
<li><a href="#_running_the_dmr_builder">B.1.1. Running the DMR++ builder</a></li>
<li><a href="#_simple_shell_command">B.1.2. Simple shell command</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_building_dmr_files_for_hdf5netcdf4_with_get_dmrpp">Appenix C: Building DMR++ files for HDF5/NetCDF4 with <em>get_dmrpp</em></a>
<ul class="sectlevel2">
<li><a href="#_using_get_dmrpp">C.1. Using <em>get_dmrpp</em></a></li>
<li><a href="#_command_line_options">C.2. Command line options</a>
<ul class="sectlevel3">
<li><a href="#_inputs">C.2.1. Inputs</a></li>
<li><a href="#_output">C.2.2. Output</a></li>
<li><a href="#_verbose_output_modes">C.2.3. Verbose Output Modes</a></li>
<li><a href="#_tests">C.2.4. Tests</a></li>
<li><a href="#_missing_data_creation">C.2.5. Missing Data Creation</a></li>
<li><a href="#_aws_integration">C.2.6. AWS Integration</a></li>
</ul>
</li>
<li><a href="#_hdf5_handler_configuration">C.3. <em>HDF5_handler</em> Configuration</a>
<ul class="sectlevel3">
<li><a href="#_note_to_daacs_with_existing_hyrax_deployments">C.3.1. Note to DAACs with existing Hyrax deployments.</a></li>
</ul>
</li>
<li><a href="#_the_h5_enablecf_option">C.4. The <em>H5.EnableCF</em> option</a></li>
<li><a href="#_missing_data_the_cf_conventions_and_hdf5">C.5. Missing data, the CF conventions and <em>HDF5</em></a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_intended_audience">1. Intended Audience</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This document is for people who want to enable access to HDF and netCDF data files stored in Amazon Web Services (AWS) Simple Storage Service (S3) using the OPeNDAP <em>Hyrax</em> data server. It describes how to build the DMR++ documents the Hyrax server uses. This document will also be useful to people who want to build DMR++ documents for other reasons, such as enabling client-side technology like <em>VirtualiZarr</em> to access/subset remote data files  using only HTTP.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
There are some features of the DMR++ builder software that are targeted specifically to the NASA Earth Science Data and Information Systems (ESDIS) project&#8217;s use of S3 to store data. Look for the <em>TIP</em> icon to find those.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">2. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The DMR++ is a metadata file that provides a fast and flexible way to access data stored in Amazon Web Services (AWS) Simple Storage Service (S3), or using any other service that supports HTTP.<sup class="footnote">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup></p>
</div>
<div id="AnatomyDMRpp" class="imageblock text-center">
<div class="content">
<img src="./images/Anatomy_DMRpp.png" alt="Anatomy DMRpp" width="100%">
</div>
<div class="title">Figure 1. Diagram showing what a DMR++ might look like for a given (individual) file. The DMR++ is an XML document containing metadata declarations of the variables and attributes within the file, and annotated with Chunk Manifests for each Array. Currently, it supports fletcher32, shuffle, and deflate as CompressionType, and deflateLevel between 1 and 9 (9 included).</div>
</div>
<div class="paragraph">
<p>OPeNDAP developed the DMR++ system in response to the growing need for faster, more efficient access to scientific data stored in large, complex files. As datasets expanded in size and migrated to cloud-based storage systems like S3, traditional methods of reading metadata and retrieving data became increasingly cumbersome and expensive. DMR++ was designed to solve this problem by creating a lightweight, annotated metadata file that describes where data elements are located and how they can be accessed, without requiring full downloads or local processing. By decoupling metadata access from the underlying storage and minimizing data movement, DMR++ enables scalable, cloud-friendly workflows that better support the demands of modern Earth science research.</p>
</div>
<div class="paragraph">
<p>The DMR++ encodes the location of data residing in a binary data file/object (e.g., an <a href="https://www.hdfgroup.org/solutions/hdf5/">HDF5</a> file) so that it can be directly accessed, without the need for an intermediate Application Programmer Interface (API) library. The binary data objects may be in a local filesystem, or they may be accessible using HTTP in, for example, an S3 bucket. The Hyrax data server from OPeNDAP can use DMR++ files to provide access and subsetting services for data stored in S3 without first copying their data files from S3. That is, Hyrax can use the DMR++ files to access and subset data 'in place.' This mirrors the behavior of the Hyrax server when used with data files stored on POSIX file systems.</p>
</div>
<div class="paragraph">
<p>The DMR++ is an extension of the Dataset Metadata Response (DMR) from OPeNDAP&#8217;s DAP4 protocol. For a full description of DAP4 and the DMR object, see the DAP4 protocol, <a href="https://opendap.github.io/dap4-specification/DAP4.html">Sections 1.5.71.5.15</a>. The <a href="https://opendap.github.io/dap4-specification/DAP4.html#_dmr_declarations">DMR</a> encodes metadata information about the names, data types, and hierarchical relations of the variables that make up a dataset. The DMR++ adds information about the location, size, and other relevant characteristics of those variables. Software can then use this information to read binary data values directly from the dataset&#8217;s file(s) without using an API library or copying the dataset to temporary storage before accessing the data.</p>
</div>
<div class="paragraph">
<p>Additional advantages to the DMR++ are:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Enables data providers to take advantage of modern storage technologies for large data without having to reformat huge data collections.</p>
</li>
<li>
<p>A DMR++ can be programmatically generated by OPeNDAP software for datasets that are made up of HDF5, NetCDF4, HDF4, and HDF4_EOS2 data files.</p>
</li>
<li>
<p>Data file integrity is preserved.</p>
</li>
</ol>
</div>
<div id="Diagram" class="imageblock text-center">
<div class="content">
<img src="./images/DMRppS3.png" alt="DMRppS3" width="70%">
</div>
<div class="title">Figure 2. A collection of HDF5 files in an S3 bucket. Each data file has an associated DMR++ file, named using the data file name with the suffix '.dmrpp'. Because the DMR++ uses a URL to reference the source data file, it can be stored 'close' to the data or on a different storage system.</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_supported_data_formats">3. Supported Data Formats</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The software to build DMR++ documents currently works with HDF5, netCDF4, HDF4, and HDF4-EOS2 files.<sup class="footnote">[<a id="_footnoteref_2" class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup> Other formats like Zarr and netCDF3 are not currently supported by the DMR++ software, but support could be added if requested.</p>
</div>
<div class="sect2">
<h3 id="_the_gory_details">3.1. The Gory Details</h3>
<div class="paragraph">
<p>Technologies such as HDF5 are best characterized as tools for defining <em>self-describing</em> data files. These files are widely adopted in scientific domains because they support a diverse range of organizational structures for information. In the case of NASA ESDIS, nearly all the more than 8,600 data collections (encompassing over one billion individual files) define distinct sets of <em>variables</em>, effectively making each collection a unique data format. Despite these differences, a small number of API libraries can be used to consistently access the data across all collections.</p>
</div>
<div class="paragraph">
<p>While we aim to provide support for all possible HDF5, HDF4, etc., data files, there are aspects of the <em>data models</em> these API libraries implement that the current DMR++ software does not cover. As of April 2025, support for HDF5, as it is used by the NASA ESDIS collections, is close to complete. The best approach to determining if the OPeNDAP DMR++ builder software will work for a given collection is to try it. We suggest picking one or two granules/files and then following the steps outlined here in <a href="#sec-build-them">Section 4</a> followed by the testing process described in <a href="#sec-test-them">Section 5</a>. Are the variables all present? Are the values, or a sampled subset of values, correct?</p>
</div>
<div class="paragraph">
<p>Support for HDF4 and HDF4-EOS2 data files is much newer, and more work will need to be done on edge cases than for HDF5. However, as of April 2025, the same advice applies to these as to the HDF5 case. Try to build the DMR++ and then test the result.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
In NASA collections using HDF4-EOS2, geolocation information is often not included within individual data files. This approach minimizes storage requirements by avoiding the repeated storage of redundant information. For instance, a MODIS collection may contain approximately 10,000 files (granules), each referencing geolocation data drawn from a common set of around 120 predefined global regions. To manage this, DMR++ generates and stores the geo-referencing information in additional compressed data files, but without an attempt to limit that to the minimum amount of the geo-referencing data. Efforts to optimize the storage of HDF4-EOS2 geo-referencing data are planned and will be prioritized based on user demand.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_is_my_netcdf_file_a_version_3_or_version_4_file">3.1.1. Is My NetCDF File A Version <em>3</em> or Version <em>4</em> File?</h4>
<div class="paragraph">
<p>OPeNDAP&#8217;s DMR++ software does not currently support netCDF3 files.<sup class="footnote">[<a id="_footnoteref_3" class="footnote" href="#_footnotedef_3" title="View footnote.">3</a>]</sup> A complicating factor in building DMR++ documents is that it can be hard to tell at a glance if a file is netCDF version 3 or version 4. A file with the suffix <em>.nc4</em> is conventionally recognized as a <em>netCDF-4</em> file. However, the file suffix <em>.nc</em> is ambiguous since it is often used for both <em>netCDF-3</em> and <em>netCDF-4</em> files.</p>
</div>
<div class="paragraph">
<p>You can use the <code>ncdump</code> command to determine if a <em>netCDF</em> file is either classic <em>netCDF-3</em> or <em>netCDF-4</em> <a href="http://www.bic.mni.mcgill.ca/users/sean/Docs/netcdf/guide.txn_79.html">(You can learn more in the NetCDF documentation here)</a>. Here are two files, both using the suffix <code>.nc</code> where the first is netCDF3 and the second is netCDF4.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="shell"><span class="line-numbers">1</span>% ncdump -k fnoc1.nc
<span class="line-numbers">2</span>classic
<span class="line-numbers">3</span>
<span class="line-numbers">4</span>% ncdump -k SMAP_L4_SM_aup_20150420T210000_Vv7032_001.nc
<span class="line-numbers">5</span>netCDF-4</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec-build-them">4. How to Build DMR++ reference files</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_assumptions">4.1. Assumptions</h3>
<div class="paragraph">
<p>You have:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Docker installed on your computer and at least a basic understanding of its use.</p>
</li>
<li>
<p>Data files in a directory on your computer</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In the following, <code>%</code> is the terminal prompt. Only some commands produce output, and for those that do, the output is shown below the command. The paths, etc., on your computer will almost certainly be different.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="sec-examples">4.2. Examples</h3>
<div class="paragraph">
<p>In this section we jump right into some examples without much explanation. This shows the minimum amount of work needed to build the DMR++ and sidecar files. See <a href="#sec-cmd-exp">Section 4.5</a> for details about the <code>gen_dmrpp_side_car</code> command, which is the recommended command for building DMR++ documents (April 2025).</p>
</div>
<div class="paragraph">
<p>Change to the directory that holds your data files and assign an environment variable to the full pathname of that directory. This will streamline some of the later steps in this section. In my case that directory is called <code>HDF4-dir</code>, and I used the environment variable 'DATA.'</p>
</div>
<div id="ex-setup" class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="shell"><span class="line-numbers">1</span>% cd HDF4-dir
<span class="line-numbers">2</span>% export DATA=$(pwd)
<span class="line-numbers">3</span>% echo $DATA
<span class="line-numbers">4</span>/Users/jimg/src/opendap/hyrax_git/HDF4-dir</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here are the files on my computer in the directory assigned to $DATA</p>
</div>
<div id="ex-dir-listing" class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="shell">% ls
3B42.19980101.00.7.HDF
3B42.19980101.03.7.HDF
3B42.19980101.06.7.HDF
3B42.19980101.09.7.HDF
3B42.20130111.06.7.HDF
3B42.20130111.09.7.HDF
AIRS.2009.01.01.L3.RetStd_IR001.v7.0.3.0.G20160024306.hdf
AIRS.2009.01.02.L3.RetStd_IR001.v7.0.3.0.G20160024358.hdf
AIRS.2009.01.03.L3.RetStd_IR001.v7.0.3.0.G20160024538.hdf
AMSR_E_L2_Land_V09_200206191023_D.hdf
AMSR_E_L2_Land_V09_200206191112_A.hdf
AMSR_E_L3_SeaIce25km_V15_20020601.hdf
MCD12Q1.A2022001.h10v06.061.2023243073808.hdf
MCD19A1.A2024025.h10v06.061.2024027100206.hdf
MOD10A1F.A2024025.h01v08.061.2024027134335.hdf
MOD10A1F.A2024025.h01v09.061.2024027130238.hdf
MOD10A1F.A2024025.h01v10.061.2024027131939.hdf
MOD11A1.A2024025.h10v06.061.2024028004317.hdf</code></pre>
</div>
</div>
<div class="paragraph">
<p>Run the Docker container. The docker run command returns the Container ID (a long hexadecimal string) when the <code>-d</code> (run a detached container) is used. The <code>--name</code> option sets <em>hyrax</em> as the name of the container which will be used in later commands. Running the container this way enables us to use both build DMR++ documents and later test them.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="shell"><span class="line-numbers">1</span>% docker run -d -h hyrax -p 8080:8080 -v $DATA:/usr/share/hyrax --name=hyrax opendap/hyrax:1.17.1-126
<span class="line-numbers">2</span>9c88a0d4abe55f17802afd81150280073314f3940b9cd4973ea60dbc43f733a9</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In this document, we use an explicit version number when we show the container being used. We do that to make sure that the information here is repeatable. In practice, you can replace that version number with the word <em>snapshot</em> to get the most recent version of the command (and the most recent bundled Hyrax server). That is, where we use <code>opendap/hyrax:1.17.1-126</code> using <code>opendap/hyrax:snapshot</code> instead will get the most recent version of the software.
</td>
</tr>
</table>
</div>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
Do not confuse the Docker tag  <em>snapshot</em> with <em>latest</em>. In all but the most unusual situations, you do <strong>NOT</strong> want the container tagged <em>latest</em>. Use the tag <em>snapshot</em>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you want to use the latest version of the <code>gen_dmrpp_side_car</code> command, replace the version number in <em>opendap/hyrax:1.17.1-126</em> with <em>snapshot</em>. Using <em>opendap/hyrax:snapshot</em> will always get the most recent version of the software.</p>
</div>
<div class="paragraph">
<p>To build a DMR++ for the first AIRS file we can run the <code>gen_dmrpp_side_car</code> command, using <code>docker exec</code>, with the file&#8217;s name. Because this file is an HDF4 file, the command option <code>-H</code> is used.</p>
</div>
<div class="listingblock">
<div class="title">Building a DMR++ for an AIRS HDF4 file/granule.</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="shell"><span class="line-numbers"> 1</span>% docker exec -it -w /usr/share/hyrax hyrax gen_dmrpp_side_car -i AIRS.2009.01.01.L3.RetStd_IR001.v7.0.3.0.G20160024306.hdf -H -U
<span class="line-numbers"> 2</span>
<span class="line-numbers"> 3</span>% ls
<span class="line-numbers"> 4</span>...
<span class="line-numbers"> 5</span>3B42.20130111.09.7.HDF
<span class="line-numbers"> 6</span>AIRS.2009.01.01.L3.RetStd_IR001.v7.0.3.0.G20160024306.hdf
<span class="line-numbers"> <strong class="highlighted">7</strong></span>AIRS.2009.01.01.L3.RetStd_IR001.v7.0.3.0.G20160024306.hdf.dmrpp
<span class="line-numbers"> 8</span>AIRS.2009.01.02.L3.RetStd_IR001.v7.0.3.0.G20160024358.hdf
<span class="line-numbers"> 9</span>...</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this second example both the DMR++ and a sidecar <em>missing data</em> file (<code>3B42.19980101.00.7.HDF_mvs.h5</code>) are built. As is often the case, the DMR++ and missing data files together are only 2% of the data file&#8217;s size.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Even though the input data file was an HDF4-EOS2 file, the missing data file uses HDF5 to store the values.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This is also an HDF4 file, so the <code>-H</code> option is used.</p>
</div>
<div id="ex-missing" class="listingblock">
<div class="title">Building both the DMR++ and a missing data file</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="shell"><span class="line-numbers"> 1</span>% docker exec -it -w /usr/share/hyrax hyrax gen_dmrpp_side_car -i 3B42.19980101.00.7.HDF -H -U
<span class="line-numbers"> 2</span>
<span class="line-numbers"> 3</span>% ls -l
<span class="line-numbers"> 4</span>total 1245840
<span class="line-numbers"> 5</span>-rw-r--r--@ 1 jimg  staff     774595 Aug 22  2024 3B42.19980101.00.7.HDF
<span class="line-numbers"> <strong class="highlighted">6</strong></span>-rw-r--r--  1 jimg  staff       6514 Apr 21 22:42 3B42.19980101.00.7.HDF.dmrpp
<span class="line-numbers"> <strong class="highlighted">7</strong></span>-rw-r--r--  1 jimg  staff       8075 Apr 21 22:42 3B42.19980101.00.7.HDF_mvs.h5
<span class="line-numbers"> 8</span>-rw-r--r--@ 1 jimg  staff     765742 Aug 22  2024 3B42.19980101.03.7.HDF
<span class="line-numbers"> 9</span> ...</code></pre>
</div>
</div>
<div class="paragraph">
<p>The final example in this section shows building a DMR++ for an HDF5 file. For an HDF5 file, do not include the <code>-H</code> option.</p>
</div>
<div id="ex-hdf5" class="listingblock">
<div class="title">Build a DMR++ for an HDF5 file.</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="shell"><span class="line-numbers">1</span>% docker exec -it -w /usr/share/hyrax hyrax gen_dmrpp_side_car -i SMAP_L4_SM_aup_20150420T210000_Vv7032_001.h5 -U
<span class="line-numbers">2</span>
<span class="line-numbers">3</span>% ls -l
<span class="line-numbers">4</span>total 1895576
<span class="line-numbers">5</span> ...
<span class="line-numbers">6</span>-rw-r--r--@ 1 jimg  staff   95114159 Aug  5  2024 SMAP_L4_SM_aup_20150420T210000_Vv7032_001.h5
<span class="line-numbers">7</span>-rw-r--r--  1 jimg  staff     277290 Apr 25 15:51 SMAP_L4_SM_aup_20150420T210000_Vv7032_001.h5.dmrpp</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec-data-source-url">4.3. How DMR++ References the Matching Data File</h3>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
This section is primarily for NASA ESDIS users of the DMR++ document builder. However, there is some generally useful information here, so most readers should skim it over.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>A DMR++ document is an eXtensible Markup Language (XML) document. We call the data file/granule that the DMR++ describes the <em>source data file</em>. Each DMR++ has at least one source data file, but may have more than one source data file, for example, with HDF4-EOS2 geo-referencing data.  The first XML <em>element</em> in the DMR++ contains a URL that points to the DMR++ document&#8217;s source data file. It looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="line-numbers">1</span><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span>
<span class="line-numbers">2</span><span class="tag">&lt;Dataset</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://xml.opendap.org/ns/DAP/4.0#</span><span class="delimiter">&quot;</span></span>
<span class="line-numbers">3</span>    <span class="attribute-name">xmlns:dmrpp</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://xml.opendap.org/dap/dmrpp/1.0.0#</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">dapVersion</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">4.0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">dmrVersion</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1.0</span><span class="delimiter">&quot;</span></span>
<span class="line-numbers">4</span>    <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">SMAP_L4_SM_aup_20150420T210000_Vv7032_001.h5</span><span class="delimiter">&quot;</span></span>
<span class="line-numbers"><strong class="highlighted">5</strong></span>    <span class="attribute-name">dmrpp:href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">https://test.opendap.org/examples/SMAP_L4_SM_aup_20150420T210000_Vv7032_001.h5</span><span class="delimiter">&quot;</span></span>
<span class="line-numbers">6</span>    <span class="attribute-name">dmrpp:version</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">3.21.1-243</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>There are three <em>XML attributes</em> in the root element of the DMR++ that are relevant to this discussion. They are:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="shell">name=&quot;SMAP_L4_SM_aup_20150420T210000_Vv7032_001.h5&quot;
dmrpp:href=&quot;https://test.opendap.org/examples/SMAP_L4_SM_aup_20150420T210000_Vv7032_001.h5&quot;
dmrpp:version=&quot;3.21.1-243&quot;&gt;</code></pre>
</div>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
name
</td>
<td class="hdlist2">
<p>The name of the data file/granule.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dmrpp:href
</td>
<td class="hdlist2">
<p>The full URL to the source data file.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
dmrpp:version
</td>
<td class="hdlist2">
<p>The version of the DMR++ builder software used to make this DMR++ document.</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The value of the <code>dmrpp:href</code> attribute is the source of data values that the Hyrax data server will use with building data responses. This URL can be either an HTTP, HTTPS or <em>file://</em> URL (for more about the latter option, see <a href="#sec-test-them">Section 5</a>.</p>
</div>
<div class="paragraph">
<p>However, when the OPeNDAP DMR++ was first developed for use by NASA ESDIS, we did not want to encode the URL to the data file into the DMR++. Instead, we planned on using the ESDIS Common Metadata Repository (CMR) to look up information about a granule and use that to find the source data file. This helped guard against having to edit many of the documents while the ESDIS system was in flux (i.e., it was a decision well aligned with agile development principles). In place of an explicit URL to the source data file, the <code>gen_dmrpp_side_car</code> will, by default, use a template string that the hyrax data server substitutes at runtime with the current data source URL as read from CMR.</p>
</div>
<div class="paragraph">
<p>What if you do not need or want that? The <code>-u</code> option of <code>gen_dmrpp_side_car</code> provides a way to tell the DMR++ document builder to use a specific value for the data source URL. The following examples show the DMR++ XML <em>with</em> the template value for the data source URL and then using a URL set with the <code>-u</code> option.</p>
</div>
<div class="listingblock">
<div class="title">With the template</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="shell"><span class="line-numbers">1</span>% docker exec -it -w /usr/share/hyrax hyrax gen_dmrpp_side_car -i SMAP_L4_SM_aup_20150420T210000_Vv7032_001.h5
<span class="line-numbers">2</span>%head  SMAP_L4_SM_aup_20150420T210000_Vv7032_001.h5.dmrpp
<span class="line-numbers">3</span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;
<span class="line-numbers">4</span>&lt;Dataset xmlns=&quot;http://xml.opendap.org/ns/DAP/4.0#&quot; xmlns:dmrpp=&quot;http://xml.opendap.org/dap/dmrpp/1.0.0#&quot; dapVersion=&quot;4.0&quot; dmrVersion=&quot;1.0&quot;
<span class="line-numbers">5</span>    name=&quot;SMAP_L4_SM_aup_20150420T210000_Vv7032_001.h5&quot;
<span class="line-numbers"><strong class="highlighted">6</strong></span>    dmrpp:href=&quot;OPeNDAP_DMRpp_DATA_ACCESS_URL&quot;
<span class="line-numbers">7</span>    dmrpp:version=&quot;3.21.1-243&quot;&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The template value for the data source URL is <code>OPeNDAP_DMRpp_DATA_ACCESS_URL</code></p>
</div>
<div class="listingblock">
<div class="title">Explicit data source URL, set using <code>-u</code></div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="shell"><span class="line-numbers">1</span>% docker exec -it -w /usr/share/hyrax hyrax gen_dmrpp_side_car -i SMAP_L4_SM_aup_20150420T210000_Vv7032_001.h5 -u https://test.opendap.org/examples/SMAP_L4_SM_aup_20150420T210000_Vv7032_001.h5
<span class="line-numbers">2</span>% head SMAP_L4_SM_aup_20150420T210000_Vv7032_001.h5.dmrpp
<span class="line-numbers">3</span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;
<span class="line-numbers">4</span>&lt;Dataset xmlns=&quot;http://xml.opendap.org/ns/DAP/4.0#&quot; xmlns:dmrpp=&quot;http://xml.opendap.org/dap/dmrpp/1.0.0#&quot; dapVersion=&quot;4.0&quot; dmrVersion=&quot;1.0&quot;
<span class="line-numbers">5</span>    name=&quot;SMAP_L4_SM_aup_20150420T210000_Vv7032_001.h5&quot;
<span class="line-numbers"><strong class="highlighted">6</strong></span>    dmrpp:href=&quot;https://test.opendap.org/examples/SMAP_L4_SM_aup_20150420T210000_Vv7032_001.h5&quot;
<span class="line-numbers">7</span>    dmrpp:version=&quot;3.21.1-243&quot;&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>-u</code> option provides the literal text for the value of the <code>dmrpp:href</code> XML attribute.</p>
</div>
</div>
<div class="sect2">
<h3 id="sec-sidecar-template">4.4. How DMR++ References a Sidecar File for Geo-referencing Data</h3>
<div class="paragraph">
<p>The mechanism described above for the data source URL, where the DMR++ builder provides a template value unless overridden using the <code>-u</code> option, applies similarly to references for sidecar geo-referencing data. By default, the name of the sidecar file itself is used. To include a template value (<code>OPeNDAP_DMRpp_SC_DATA_ACCESS_URL</code>) instead, the <code>-U</code> option must be specified. As with the data source URL, the <code>-s</code> option (described below in <a href="#sec-cmd-exp">Section 4.5</a>) may be used to explicitly set the sidecar file URL.</p>
</div>
<div class="paragraph">
<p>There is one exception to the rule that <code>-u</code> is used for the data source URL and <code>-s</code> is used for the sidecar data file. If <code>-u</code> is used, that name will be used as a <em>pattern</em> for the sidecar data file such that the missing data file will be assumed to be named the same as the data source, but with the suffix <code>_mvs.h5</code>.</p>
</div>
<div class="paragraph">
<p>In this example, we show the three files made from an HDF4-EOS2 file that where the sidecar file is necessary. The output of the command is shown first, followed by two views inside the DMR++ document.</p>
</div>
<div class="listingblock">
<div class="title">An Explicit Data Source URL is a Pattern for an Explicit Sidecar Data URL</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="shell"><span class="line-numbers">1</span>% docker exec -it -w /usr/share/hyrax hyrax gen_dmrpp_side_car -i 3B42.20190110.06.7.HDF -H -u file:///usr/share/hyrax/3B42.20190110.06.7.HDF
<span class="line-numbers">2</span>
<span class="line-numbers">3</span>% ls -l
<span class="line-numbers">4</span>total 1895672
<span class="line-numbers">5</span>-rw-r--r--@ 1 jimg  staff     600255 Aug 22  2024 3B42.20190110.06.7.HDF
<span class="line-numbers"><strong class="highlighted">6</strong></span>-rw-r--r--  1 jimg  staff       6595 Apr 25 17:21 3B42.20190110.06.7.HDF.dmrpp
<span class="line-numbers"><strong class="highlighted">7</strong></span>-rw-r--r--  1 jimg  staff       8075 Apr 25 17:21 3B42.20190110.06.7.HDF_mvs.h5</code></pre>
</div>
</div>
<div class="listingblock">
<div class="title">The Resulting XML, edited. Look for the <em><a href="file:///" class="bare">file:///</a></em> URLs marked with the comments <em>HERE</em>.</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="xml"><span class="line-numbers"> 1</span><span class="preprocessor">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;</span>
<span class="line-numbers"> 2</span><span class="tag">&lt;Dataset</span> <span class="attribute-name">xmlns</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://xml.opendap.org/ns/DAP/4.0#</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">xmlns:dmrpp</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">http://xml.opendap.org/dap/dmrpp/1.0.0#</span><span class="delimiter">&quot;</span></span>
<span class="line-numbers"> 3</span>    <span class="attribute-name">dapVersion</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">4.0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">dmrVersion</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1.0</span><span class="delimiter">&quot;</span></span>
<span class="line-numbers"> 4</span>    <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">3B42.20190110.06.7.HDF</span><span class="delimiter">&quot;</span></span>
<span class="line-numbers"> <strong class="highlighted">5</strong></span>    <span class="attribute-name">dmrpp:href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">file:///usr/share/hyrax/3B42.20190110.06.7.HDF</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>                    <span class="comment">&lt;!-- HERE --&gt;</span>
<span class="line-numbers"> 6</span>    <span class="tag">&lt;Dimension</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">nlon</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">1440</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="line-numbers"> 7</span>    <span class="tag">&lt;Dimension</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">nlat</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">size</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">400</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="line-numbers"> 8</span>    <span class="tag">&lt;Float32</span> <span class="attribute-name">name</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">nlat</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
<span class="line-numbers"> 9</span>        ...
<span class="line-numbers">10</span>        <span class="tag">&lt;dmrpp:chunks</span> <span class="attribute-name">compressionType</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">deflate</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">deflateLevel</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">4</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">fillValue</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">0</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">byteOrder</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">LE</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
<span class="line-numbers">11</span>            <span class="tag">&lt;dmrpp:chunkDimensionSizes&gt;</span>400<span class="tag">&lt;/dmrpp:chunkDimensionSizes&gt;</span>
<span class="line-numbers">12</span>            <span class="tag">&lt;dmrpp:chunk</span> <span class="attribute-name">offset</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">5435</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">nBytes</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">636</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">chunkPositionInArray</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">[0]</span><span class="delimiter">&quot;</span></span>
<span class="line-numbers">13</span>                <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">file:///usr/share/hyrax/3B42.20190110.06.7.HDF_mvs.h5</span><span class="delimiter">&quot;</span></span> <span class="tag">/&gt;</span>     <span class="comment">&lt;!-- HERE --&gt;</span>
<span class="line-numbers">14</span>        <span class="tag">&lt;/dmrpp:chunks&gt;</span>
<span class="line-numbers">15</span>        ...</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sec-cmd-exp">4.5. Explanation of the <code>gen_dmrpp_side_car</code> Command Options</h3>
<div class="paragraph">
<p>The gen_dmrpp_side_car command takes a few options that control how it builds DMR++ and sidecar files.</p>
</div>
<div class="hdlist">
<table>
<colgroup>
<col style="width: 11%;">
<col>
</colgroup>
<tr>
<td class="hdlist1">
-i
</td>
<td class="hdlist2">
<p>The <code>-i</code> option is used to name the <em>input data file</em>. This data file should be found in the directory where the command is being run, or one of its child directories. In the latter case, the relative pathname to the file should be used. This option is required.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
-H
</td>
<td class="hdlist2">
<p>The <code>-H</code> option tells the command that the input file is an HDF4 or HDF4-EOS2 data file. If the <code>-H</code> option is not used, then the data file is assumed to be either HDF5 or netCDF4.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
-c
</td>
<td class="hdlist2">
<p>The <code>-c</code> option results in DMR++ and sidecar files that follow the Climate Forecast (CF) conventions. Using this option provides a DMR++ that mimics the behavior of the Hyrax server when it is used to serve data stored on POSIX file systems with the <em>EnableCF</em> option turned on. This organizes the presentation of the variables to follow CF and flattens the internal hierarchy of the data files, hiding any <em>Groups</em>.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
-D
</td>
<td class="hdlist2">
<p>The <code>-D</code> option will disable the build of a sidecar file, even when one would normally be required. The default is to build sidecar data files when needed.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
-U
</td>
<td class="hdlist2">
<p>Use the template value (<code>OPeNDAP_DMRpp_SC_DATA_ACCESS_URL</code>) for the value of the sidecar data file URL. The default is to use only the name of the template file. In most cases, if a sidecar file is made the <code>-U</code> or <code>-u &lt;URL&gt;</code> options should be used.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
-u/--URL
</td>
<td class="hdlist2">
<p>The <code>-u/--URL</code> and <code>-s/--SURL</code> options control how URLs are represented in the DMR++ document. It is possible to build a DMR++ before the location of the data file in S3, for example, is known. In this case, the URL that references the data file will be represented by a 'template' value and substituted into the DMR++ <em>when the document is used</em>, nominally by the Hyrax service at runtime (although other software can also do this substitution - it is a simple text replacement). See  <a href="#sec-data-source-url">Section 4.3</a>. If this option is used, no run-time substitution of the data source URL will be performed.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
-s/--SURL
</td>
<td class="hdlist2">
<p>The <code>-s/--SURL</code> option provides the same feature for the URL that references the sidecar geo-referencing data file. The Hyrax service <em>assumes</em> that the data file URL can be determined by removing the suffix <code>.dmrpp</code> from the DMR++ URL. Similarly, it assumes that the sidecar data file URL can be found by replacing the <code>.dmrpp</code> suffix with <code>_mvs.h5</code>. See <a href="#ex-missing">Building both the DMR++ and a missing data file</a>. Note that these options can be used to provide real values for data file and sidecar data URls. In that case, the given values will be used in the DMR++ instead of the template values. No run-time substitution of the URLs will be performed.</p>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_explanation_of_the_docker_run_command_options">4.6. Explanation of the <code>docker run</code> Command Options</h3>
<div id="sec-docker-exp" class="paragraph">
<p>In the  <a href="#sec-examples">Section 4.2</a> we used one docker command to start a container and then a second docker command to run the DMR++ builder inside that container. Here is an explanation of those commands in more detail. First, the container is started on the host computer.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="shell"><span class="line-numbers">1</span>% docker run -d -h hyrax -p 8080:8080 -v $DATA:/usr/share/hyrax --name=hyrax opendap/hyrax:1.17.1-126
<span class="line-numbers">2</span>9c88a0d4abe55f17802afd81150280073314f3940b9cd4973ea60dbc43f733a9</code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>docker run -d &#8230;&#8203;</code> command will run the Hyrax container on your computer (called the <em>host</em> computer) in <em>detached</em> mode. The Hyrax container includes both the complete Hyrax service and the <code>gen_dmrpp_side_car</code> command. Later this server will be used to test the DMR++ documents that are built.</p>
</div>
<div class="paragraph">
<p>The volume mount, from <code>$DATA</code> to <code>/usr/share/hyrax</code> mounts the current directory of the host computer running the container to the directory <em>/usr/share/hyrax</em> inside the container. That directory is the root of the Hyrax server&#8217;s data tree. This means that the data files in the <code>$DATA</code> directory will be accessible by the server running in the container without any other configuration.</p>
</div>
<div class="paragraph">
<p>Complete option summary:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
-d, --detach
</td>
<td class="hdlist2">
<p>Run container in the background and print container ID</p>
</td>
</tr>
<tr>
<td class="hdlist1">
-h, --hostname
</td>
<td class="hdlist2">
<p>Set the container&#8217;s host name</p>
</td>
</tr>
<tr>
<td class="hdlist1">
-p, --publish
</td>
<td class="hdlist2">
<p>Publish a container&#8217;s port(s) to the Docker host</p>
</td>
</tr>
<tr>
<td class="hdlist1">
-v, --volume
</td>
<td class="hdlist2">
<p>Mount a volume so that the container can use files on the Docker host</p>
</td>
</tr>
<tr>
<td class="hdlist1">
--name
</td>
<td class="hdlist2">
<p>Assign a name to the container; this name can be used in later Docker commands</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Once running, the container is used to run the command that will build the DMR++ document.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="shell">% docker exec -it -w /usr/share/hyrax hyrax gen_dmrpp_side_car -i 3B42.19980101.00.7.HDF -H -U</code></pre>
</div>
</div>
<div class="paragraph">
<p>The command that built the DMR++ (and sidecar) file really consists of <em>two commands</em>. The first is <code>docker exec -it -w /usr/share/hyrax hyrax</code> which instructs docker to <em>execute</em> a program in the running container named <em>hyrax</em> and do so by first changing to the directory <em>/usr/share/hyrax</em> in that container. By using the <code>-w</code> option we are able to run the gen_dmrpp_side_car command in the directory within the container where data appear.</p>
</div>
<div class="paragraph">
<p>The second command instructs the docker container to run <code>gen_dmrpp_side_car</code> using the arguments <code>-i 3B42.19980101.00.7.HDF -H -U</code> which mean use the file <em>3B42.19980101.00.7.HDF</em> as the input data file, assume it is an HDF4 file and use the template name for the sidecar data file.</p>
</div>
<div class="paragraph">
<p>Complete option summary for the <code>docker exec</code> command:</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
-i, --interactive
</td>
<td class="hdlist2">
<p>Set the working directory inside the container</p>
</td>
</tr>
<tr>
<td class="hdlist1">
-t, --tty
</td>
<td class="hdlist2">
<p>Allocate a pseudo-terminal</p>
</td>
</tr>
<tr>
<td class="hdlist1">
-w, --workdir
</td>
<td class="hdlist2">
<p>Set the working directory inside the container</p>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="sec-test-them">5. Testing DMR++ Containers Using the Builtin Hyrax Server</h2>
<div class="sectionbody">
<div class="paragraph">
<p>One of the more confounding things about testing DMR++ documents is that it requires a data server, or some software component, that can interpret the documents. Instead of the data being directly available, the DMR++ sits between the software and the data. In this section we show how to test a DMR++ document that using the Hyrax server running in the container used to build the DMR++ document. To do this, we will build the DMR++ with <em>file URLs</em> for the data and sidecar files instead of <em>HTTP URLs</em> or the <em>template values</em> that the command would normally use.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">% docker exec -it -w /usr/share/hyrax hyrax gen_dmrpp_side_car -i 3B42.20130111.09.7.HDF -H -u 'file:///usr/share/hyrax/3B42.20130111.09.7.HDF'</pre>
</div>
</div>
<div class="paragraph">
<p>Copy that pattern for whatever file you use. From the <code>/usr/share/hyrax</code> directory, you pass <em>gen_dmrpp_side_car</em> the name of the file (because it&#8217;s local to the current directory) using the <code>-i</code> option. The <code>-u</code> option tells the command to embed the URL that follows it in the DMR++. I&#8217;ve used a <em>file://</em>  URL to the file <em>/usr/share/hyrax/3B42.19980101.00.7.HDF</em>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In the URL above, three slashes follow the colon: two from the way a URL names a protocol and one because the pathname starts at the root directory.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Let&#8217;s look at how the <em>hyrax</em> service will treat that data file using the DMR++. In a browser, go to  <a href="http://localhost:8080/opendap/">http://localhost:8080/opendap/</a>. The <em>hyrax</em> container must be started using the <code>docker run</code> command for this to work (<a href="#sec-examples">Section 4.2</a>).</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/Hyrax-including-new-DMRpp.png" alt="Hyrax including new DMRpp" width="650" height="400">
</div>
<div class="title">Figure 3. Hyrax Catalog view of all files available.</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The server caches data catalog information for 5 minutes (although this can be configured) so new items (e.g., DMR++ documents) may not show up right away. To force the display of a DMR++ that you just created, click on the source data file name and edit the URL so that the suffix <code>.dmr.html</code> is replaced by <code>.dmrpp.dmr</code> .
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Click on your equivalent of the <code>3B42.20130111.09.7.HDF</code> link, subset, download, and open in Panoply or the equivalent.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/Hyrax-subsetting.png" alt="Hyrax subsetting" width="650" height="400">
</div>
<div class="title">Figure 4. Page view of the DAP <em>Data Request Form</em> for subsetting the dataset.</div>
</div>
<div class="paragraph">
<p>You can run batch tests in lots of files by building many DMR++ documents and then asking the server for various responses (<em>nc4</em>, <em>dap</em>) from the DMR++ and the original file. Those could be compared using various schemes such as the command <em>getdap4</em> included in the container. The <code>getdap4</code> command can be used to compare the <em>dap</em> responses from the data file and the DMR++ document.</p>
</div>
<div class="paragraph">
<p>Below is a comparison of the same underlying data, the left window shows the data returned using the DMR++, the right shows the data read directly from the file using the server&#8217;s builtin HDF4 reader.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="./images/Data-comparison.png" alt="Data comparison" width="650" height="400">
</div>
<div class="title">Figure 5. Comparison of responses from a DMR++ (left) and the native file handler (right).</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_serving_data_using_dmr_files">6. Serving Data Using DMR++ Files</h2>
<div class="sectionbody">
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This is older text that repeats some of the above material, but it provides a good reference for using the DMR++ in a range of data provider situations.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>There are three fundamental deployment scenarios for using DMR++ files to serve data with the Hyrax data server.</p>
</div>
<div class="paragraph">
<p>This can be simply categorized as follows:
The DMR++ file(s) are XML files that contain a root <code>dap4:Dataset</code> element with a <code>dmrpp:href</code> attribute whose value is one of:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>A http(s):// URL referencing to the underlying granule files via http.</p>
</li>
<li>
<p>A file:// URL that references the granule file on the local filesystem in a location that is inside the BES' data root tree.</p>
</li>
<li>
<p>The template string <code>OPeNDAP_DMRpp_DATA_ACCESS_URL</code></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Each will be discussed in turn below.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
By default, Hyrax will automatically associate files whose name ends with ".dmrpp" with the <strong>DMR++</strong> handler.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_using_dmr_with_https_urls">6.1. Using DMR++ with HTTP/S URLs</h3>
<div class="paragraph">
<p>If the DMR++ files that you wish to serve contain <code>dmrpp:href</code> attributes whose values are http(s) URLs then there are 2+1 steps to serve the data:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Place the DMR++ files on the local disk inside the directory tree identified by the <code>BES.Catalog.catalog.RootDirectory</code> in the BES configuration.</p>
</li>
<li>
<p>Ensure that the Hyrax <code>AllowedHosts</code> list is configured to allow Hyrax to access those target URLs. This can be done by adding new regex records to the <code>AllowedHosts</code> list in <code>/etc/bes/site.conf</code>, creating that file as need be.</p>
</li>
<li>
<p>If the data URLs require authentication to access, then you&#8217;ll need to configure Hyrax for that too. See <a href="https://opendap.github.io/hyrax_guide/Master_Hyrax_Guide.html#_authentication_and_authorization">The Hyrax Data Server Installation and Configuration Guide</a> for more information.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_using_dmr_with_file_urls">6.2. Using DMR++ with file URLs</h3>
<div class="paragraph">
<p>Using DMR++ files with locally held files can be useful for verifying that DMR++ functionality is working without relying on network access that may have data rate limits, authenticated access configuration, or security access constraints. Additionally, in many cases the DMR++ access to the locally held data may be faster than through the native <code>netcdf-4/HDF5</code> data handlers.</p>
</div>
<div class="paragraph">
<p>To use DMR++ files that contain <code>file://</code> URLs:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Place the DMR++ files on the local disk inside the directory tree identified by the <code>BES.Catalog.catalog.RootDirectory</code> in the BES configuration.</p>
</li>
<li>
<p>Ensure that the DMR++ files contain only file:// URLs that refer to data granule files that are inside the directory tree identified by the <code>BES.Catalog.catalog.RootDirectory</code> in the BES configuration.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Note: For Hyrax, a correctly formatted file URL must start with the protocol <code>file://</code> followed by the full qualified path to the data granule, for example:</p>
</div>
<div class="paragraph">
<p><code>/usr/share/hyrax/ghrsst/some_granule.h5</code></p>
</div>
<div class="paragraph">
<p>so that the completed URL will have three slashes after the first colon:</p>
</div>
<div class="paragraph">
<p><code><a href="file:///usr/share/hyrax/ghrsst/some_granule.h5" class="bare">file:///usr/share/hyrax/ghrsst/some_granule.h5</a></code></p>
</div>
</div>
<div class="sect2">
<h3 id="_using_dmr_with_the_template_string_nasa">6.3. Using DMR++ with the template string (NASA).</h3>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
This is most relevant to the operation of the NASA ESDIS Hyrax in the Cloud server deployment.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Another way to serve DMR++ files with Hyrax is to build the DMR++ files <strong>without</strong> valid URLs but with a template string that is replaced at runtime. If no target URL is supplied to <em>get_drmpp</em> at the time that the DMR++ is generated the template string: <code><strong>OPeNDAP_DMRpp_DATA_ACCESS_URL</strong></code> will be added to the file in place of the URL. The at runtime it can be replaced with the correct value.</p>
</div>
<div class="paragraph">
<p>Currently, the only implementation of this is Hyrax&#8217;s NGAP service that, when deployed in the NASA NGAP cloud, will accept <em>REST_</em> URLs that are defined as having a URL path component with two mandatory and one optional parameters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"> MANDATORY: "/collections/UMM-C:{concept-id}"
 MANDATORY: "/granules/UMM-G:{GranuleUR}"</pre>
</div>
</div>
<div class="listingblock">
<div class="title">Example Hyrax in the Cloud REST URL</div>
<div class="content">
<pre class="CodeRay highlight nowrap"><code>https://opendap.earthdata.nasa.gov/collections/C1443727145-LAADS/granules/MOD08_D3.A2020308.061.2020309092644.hdf.nc</code></pre>
</div>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
UMM-C:{concept-id}
</td>
<td class="hdlist2">
<p>/collections/C1443727145-LAADS</p>
</td>
</tr>
<tr>
<td class="hdlist1">
UMM-G:{GranuleUR}
</td>
<td class="hdlist2">
<p>/granules/MOD08_D3.A2020308.061.2020309092644.hdf.nc</p>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When encountering this type of URL, Hyrax will decompose it and use the content to formulate a query to the NASA CMR to retrieve the data access URL for the granule and for the DMR++ file. It then retrieves the DMR++ file and injects the data URL so that data access can proceed as described above.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
More on the REST Path can be found <a href="https://wiki.earthdata.nasa.gov/display/DUTRAIN/Feature+analysis%3A+Restified+URL+for+OPENDAP+Data+Access">here</a>. You need access to the NASA ESDIS Earthdata Wiki to follow that link.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_useful_docker_commands">Appenix A: Useful Docker Commands</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A useful docker command, <code>ps</code>, provides a way to see which docker containers are running.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="shell">% docker ps</code></pre>
</div>
</div>
<div class="paragraph">
<p>or make a command alais for a more compact listing than the default output of <code>docker ps</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="shell">% alias d-ps='docker ps --format &quot;table {{.ID}}\t{{.Names}}\t{{.Status}}\t{{.Image}}&quot;'</code></pre>
</div>
</div>
<div class="paragraph">
<p>This will show a somewhat easier-to-read bit of information about all the running Docker containers on your host:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="shell">% d-ps

CCONTAINER ID   NAMES     STATUS          IMAGE
82074fe6ccfe    hyrax     Up 13 minutes   opendap/hyrax:1.17.1-126</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you want to stop the container, use</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight nowrap"><code data-lang="shell">% docker rm -f hyrax</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_building_dmr_files_for_hdf4_and_hdf4_eos2_advanced">Appenix B: Building DMR++ files for HDF4 and HDF4-EOS2 (advanced)</h2>
<div class="sectionbody">
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This appendix documents an advanced command (<code>get_dmrpp_h4</code>) that is used to build DMR++ documents for HDF4 and HDF4-EOS2. For most people we recommend using <code>gen_dmrpp_side_car</code> instead. <em>Caveat emptor</em>. See <a href="#sec-build-them">Section 4</a> for up-to-date information on building the DMR++.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The HDF4 and HDF4-EOS2 (hereafter just HDF4) DMR++ document builder is currently available in the docker container we build for <a href="https://www.opendap.org/software/hyrax-data-server/">hyrax</a> server/service. You can get this container from <a href="https://hub.docker.com/repository/docker/opendap/hyrax">our public Docker Hub repository</a>. You can also get and build the ''Hyrax'' source code and use the client that way (as part of a source code build), but it&#8217;s much more complex than getting the Docker container. In addition, the Docker container includes a server that can test the DMR++ documents that are built and can even show you how the files would look when served without using the DMR++.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The following commands should be considered still experimental and subject to some change. Modify it to suit your own needs.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_using_get_dmrpp_h4">B.1. Using get_dmrpp_h4</h3>
<div class="paragraph">
<p>Make a new directory in a convenient place and copy the HDF4 and/or HDF4-EOS2 files in that directory. Once you have the files in that directory, make an environment variable so it can be referred to easily. From inside the directory:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">export HDF4_DIR=$(pwd)</pre>
</div>
</div>
<div class="paragraph">
<p>Get the Docker container from Docker Hub using this command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">docker run -d -h hyrax -p 8080:8080 -v $HDF4_DIR:/usr/share/hyrax --name=hyrax opendap/hyrax:snapshot</pre>
</div>
</div>
<div class="paragraph">
<p>What the options mean:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">-d, --detach Run container in background and print container ID
-h, --hostname Container host name
-p, --publish Publish a container's port(s) to the host
-v, --volume Bind mount a volume
--name Assign a name to the container</pre>
</div>
</div>
<div class="paragraph">
<p>This command will fetch the container <strong>opendap/hyrax:snapshot</strong> from Docker Hub. The <em>snapshot</em> is the most recent build of the container. It will then <em>run</em> the container and return the container ID. The <em>hyrax</em> server is now running on your computer and can be accessed with a web browser, curl, etc. More on that in a bit.</p>
</div>
<div class="paragraph">
<p>The volume mount, from <code>$HDF4_DIR</code> to <code>'/usr/share/hyrax'</code> mounts the current directory of the host computer running the container to the directory <em>/usr/share/hyrax</em> inside the container. That directory is the root of the server&#8217;s data tree. This means that the HDF4 files you copied into the <code>HDF4_DIR</code> directory will be accessible by the server running in the container. That will be useful for testing later on.</p>
</div>
<div class="paragraph">
<p>Note: If you want to use a specific container version, substitute the version info for <em>snapshot.</em></p>
</div>
<div class="sect3">
<h4 id="_running_the_dmr_builder">B.1.1. Running the DMR++ builder</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
At the end of this, I&#8217;ll include a shell script that takes away many of these steps. However, the script obscures some aspects of the command that you might want to tweak, so the following shows you all the details. Skip to <strong>Simple shell command</strong> to skip over these details.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Make sure you are in the directory with the HDF4 files for these steps.</p>
</div>
<div class="paragraph">
<p>Get the command to return its help information:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">docker exec -it hyrax get_dmrpp_h4 -h</pre>
</div>
</div>
<div class="paragraph">
<p>will return:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">usage: get_dmrpp_h4 [-h] -i I [-c CONF] [-s] [-u DATA_URL] [-D] [-v]

Build a dmrpp file for an HDF4 file. get_dmrpp_h4 -i h4_file_name. A dmrpp
file that uses the HDF4 file name will be generated.

optional arguments:

...</pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s build a DMR++ now, by explicitly using the container:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">docker exec -it hyrax bash</pre>
</div>
</div>
<div class="paragraph">
<p>starts the <em>bash</em> shell in the container, with the current directory as root (/)</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">[root@hyrax /]#</pre>
</div>
</div>
<div class="paragraph">
<p>Change to the directory that is the root of the data (you&#8217;ll see your HDF4 files in here):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"> cd /usr/share/hyrax</pre>
</div>
</div>
<div class="paragraph">
<p>You will see, roughly:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">[root@hyrax /]# cd /usr/share/hyrax
[root@hyrax hyrax]# ls
3B42.19980101.00.7.HDF
3B42.19980101.03.7.HDF
3B42.19980101.06.7.HDF
...</pre>
</div>
</div>
<div class="paragraph">
<p>In that directory, use the <em>get_dmrpp_h4</em> command to build a DMR++ document for one of the files:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">[root@hyrax hyrax]# get_dmrpp_h4 -i 3B42.20130111.09.7.HDF -u 'file:///usr/share/hyrax/3B42.20130111.09.7.HDF'</pre>
</div>
</div>
<div class="paragraph">
<p>Copy that pattern for whatever file you use. From the <code>/usr/share/hyrax</code> directory, you pass <em>get_dmrpp_h4</em> the name of the file (because it&#8217;s local to the current directory) using the <strong>-i</strong> option. The <strong>-u</strong> option tells the command to embed the URL that follows it in the DMR++. I&#8217;ve used a <em>file://</em>  URL to the file <em>/usr/share/hyrax/3B42.19980101.00.7.HDF</em>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
In the URL above, three slashes follow the colon: two from the way a URL names a protocol and one because the pathname starts at the root directory.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Building the DMR++ and embedding a <em>file://</em> URL will enable testing the DMR++.</p>
</div>
</div>
<div class="sect3">
<h4 id="_simple_shell_command">B.1.2. Simple shell command</h4>
<div class="paragraph">
<p>Here is a simple shell command that you can run on the host computer that will eliminate most of the above.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
''In the spirit of a recipe, I&#8217;ll restate the earlier command for starting the docker container with the <strong>get_dmrpp_h4</strong> command and the <strong>hyrax</strong> server.''
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Start the container:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">docker run -d -h hyrax -p 8080:8080 -v $HDF4_DIR:/usr/share/hyrax --name=hyrax opendap/hyrax:snapshot</pre>
</div>
</div>
<div class="paragraph">
<p>Check if it is running:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">docker ps</pre>
</div>
</div>
<div class="paragraph">
<p>The command, written for the Bourne Shell, is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">#!/bin/sh
#
# usage get_dmrpp_h4.sh &lt;file&gt;

data_root=/usr/share/hyrax

cat &lt;&lt;EOF | docker exec --interactive hyrax sh
cd $data_root
get_dmrpp_h4 -i $1 -u "file://$data_root/$1"
EOF</pre>
</div>
</div>
<div class="paragraph">
<p>Copy that, save it in a file (I named the file <em>get_dmrpp_h4.sh</em>).</p>
</div>
<div class="paragraph">
<p>Run the command on the host, not the docker container, and in the directory with the HDF4 files (you don&#8217;t have to do that, but sorting out the details is left as an exercise for the reader. Run the command like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"> ./get_dmrpp_h4.sh AMSR_E_L3_SeaIce25km_V15_20020601.hdf</pre>
</div>
</div>
<div class="paragraph">
<p>The DMR++ will appear when the command completes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">(hyrax500) hyrax_git/HDF4-dir % ls -l
total 1251240
-rw-r--r--@ 1 jimg  staff    1250778 Aug 22 22:31 AMSR_E_L2_Land_V09_200206191112_A.hdf
-rw-r--r--@ 1 jimg  staff   20746207 Aug 22 22:32 AMSR_E_L3_SeaIce25km_V15_20020601.hdf
-rw-r--r--  1 jimg  staff    3378674 Aug 28 17:37 AMSR_E_L3_SeaIce25km_V15_20020601.hdf.dmrpp</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_building_dmr_files_for_hdf5netcdf4_with_get_dmrpp">Appenix C: Building DMR++ files for HDF5/NetCDF4 with <em>get_dmrpp</em></h2>
<div class="sectionbody">
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
This appendix documents a deprecated command (<code>get_dmrpp</code>) that was used to build DMR++ documents for HDF5 and netCDF4 before <code>gen_dmrpp_side_car</code> was introduced. <em>Caveat emptor</em>.  See <a href="#sec-build-them">Section 4</a> for up-to-date information on building the DMR++.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The application that builds the DMR++ files is a command line tool called <em>get_dmrpp</em>. It in turn uses other executables such as <em>build_dmrpp</em>, <em>reduce_mdf</em>, <em>merge_dmrpp</em> (which rely in turn on the <em>HDF5_handler</em> and the HDF5 library), along with a number of UNIX shell commands.</p>
</div>
<div class="paragraph">
<p>All of these components are installed with each recent version of the Hyrax Data Server</p>
</div>
<div class="paragraph">
<p>You can see the <em>get_dmrpp</em> usage statement with the command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap">get_dmrpp -h</pre>
</div>
</div>
<div class="sect2">
<h3 id="_using_get_dmrpp">C.1. Using <em>get_dmrpp</em></h3>
<div class="paragraph">
<p>The way that <em>get_dmrpp</em> is invoked controls the way that the data are ultimately represented in the resulting DMR++ file(s).</p>
</div>
<div class="paragraph">
<p>The <em>get_dmrpp</em> application uses software from the Hyrax data server to produce the base DMR document which is used to construct the DMR++ file.</p>
</div>
<div class="paragraph">
<p>The Hyrax server has a long list of configuration options, several of which can substantially alter the structural and semantic representation of the dataset as seen in the DMR++ files generated using these options.</p>
</div>
</div>
<div class="sect2">
<h3 id="_command_line_options">C.2. Command line options</h3>
<div class="paragraph">
<p>The command line switches provide a way to control the output of the tool. In addition to common options like verbose output or testing modes, the tool provides options to build extra (aka 'sidecar') data files that hold information needed for CF compliance. See the ''missing data'' section for more information. In addition, it is often desirable to build DMR++ files before the source data files are uploaded to a cloud store like S3. In this case, the URL to the data may not be known when the DMR++ is built. We support this by using placeholder/template strings in the ''dmr++'' and which can then be replaced with the URL at runtime, when the DMR++ file is evaluated. See the '-u' and '-p' options below.</p>
</div>
<div class="sect3">
<h4 id="_inputs">C.2.1. Inputs</h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><strong>-b</strong> </dt>
<dd>
<p>The fully qualified path to the top-level data directory. Data files read by <em>get_dmrpp</em> must be in the directory tree rooted at this location and their names expressed as a path relative to this location. The value may not be set to <code>/</code> , or <code>/etc</code>. The default value is <code>/tmp</code> if a value is not provided. All the data files to be processed must be in this directory or one of its subdirectories. If <em>get_dmrpp</em> is being executed from same directory as the data then <code>-b `pwd`</code> or <code>-b .</code> works as well.</p>
</dd>
<dt class="hdlist1"><strong>-u</strong> </dt>
<dd>
<p>This option is used to specify the location of the binary data object. Its value must be <code>http</code>, <code>https</code>, or a <code>file://</code> URL. This URL will be injected into the DMR++ when it is constructed. If option <code>-u</code> is not used; then the template string <code>OPeNDAP_DMRpp_DATA_ACCESS_URL</code> will be used and the DMR++ will substitute a value at runtime.</p>
</dd>
<dt class="hdlist1"><strong>-c</strong> </dt>
<dd>
<p>The path to an alternate bes configuration file to use.</p>
</dd>
<dt class="hdlist1"><strong>-s</strong> </dt>
<dd>
<p>The path to an optional addendum configuration file which will be appended to the default BES configuration. Much like the <code>site.conf</code> file works for the full server deployment it will be loaded last and the settings there-in will affect the default configuration.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_output">C.2.2. Output</h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><strong>-o</strong> </dt>
<dd>
<p>The name of the file to create.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_verbose_output_modes">C.2.3. Verbose Output Modes</h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><strong>-h</strong> </dt>
<dd>
<p>Show the help/usage page.</p>
</dd>
<dt class="hdlist1"><strong>-v</strong> </dt>
<dd>
<p>verbose mode, prints the intermediate DMR.</p>
</dd>
<dt class="hdlist1"><strong>-V</strong> </dt>
<dd>
<p>Very verbose mode, prints the DMR, the command, and the configuration file used to build the DMR.</p>
</dd>
<dt class="hdlist1"><strong>-D</strong> </dt>
<dd>
<p>Print the DMR that will be used to build the DMR++.</p>
</dd>
<dt class="hdlist1"><strong>-X</strong> </dt>
<dd>
<p>Do not remove temporary files. May be used independently of the <code>-v</code> and/or <code>-V</code> options.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_tests">C.2.4. Tests</h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><strong>-T</strong> </dt>
<dd>
<p>Run ALL hyrax tests on the resulting DMR++ file and compare the responses the ones generated by the source HDF5 file.</p>
</dd>
<dt class="hdlist1"><strong>-I</strong> </dt>
<dd>
<p>Run hyrax inventory tests on the resulting DMR++ file and compare the responses the ones generated by the source HDF5 file.</p>
</dd>
<dt class="hdlist1"><strong>-F</strong> </dt>
<dd>
<p>Run hyrax value probe tests on the resulting DMR++ file and compare the responses the ones generated by the source HDF5 file.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_missing_data_creation">C.2.5. Missing Data Creation</h4>
<div class="dlist">
<dl>
<dt class="hdlist1"><strong>-M</strong> </dt>
<dd>
<p>Build a 'sidecar' file that holds missing information needed for CF compliance (e.g., Latitude, Longitude and Time coordinate data).</p>
</dd>
<dt class="hdlist1"><strong>-p</strong> </dt>
<dd>
<p>Provide the URL for the Missing data sidecar file. If this is not given (but -M is), then a template value is used in the DMR++ file and a real URL is substituted at runtime.</p>
</dd>
<dt class="hdlist1"><strong>-r</strong> </dt>
<dd>
<p>The path to the file that contains missing variable information for sets of input data files that share common missing variables. The file will be created if it doesn&#8217;t exist and the result may be used in later invocations of <em>get_dmrpp</em> (using <code>-r</code>) to identify the missing variable file.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_aws_integration">C.2.6. AWS Integration</h4>
<div class="paragraph">
<p>The <em>get_dmrpp</em> application supports both S3 hosted granules as inputs, and uploading generated DMR++ files to an S3 bucket.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><strong>S3 Hosted granules are supported by default</strong> </dt>
<dd>
<p>When the <code>get_dmrpp</code> application sees that the name of the input file is an S3 URL it will check to see if the AWS CLI is configured and if so <code>get_dmrpp</code> will attempt retrieve the granule and make a DMR++ utilizing whatever other options have been chosen. <strong>For example:</strong></p>
<div class="literalblock">
<div class="content">
<pre class="nowrap">get_dmrpp -b `pwd` s3://bucket_name/granule_object_id</pre>
</div>
</div>
</dd>
<dt class="hdlist1"><strong>-U</strong> </dt>
<dd>
<p>The <code>-U</code> command line parameter for <code>get_dmrpp</code> instructs <code>get_dmrpp</code> application to upload the generated DMR++ file to S3, but only when the following conditions are met:</p>
<div class="ulist">
<ul>
<li>
<p>The name of the input file is an S3 URL.</p>
</li>
<li>
<p>The <code>AWS CLI</code> has been configured with credentials that provide <code>r+w</code> permissions for the bucket referenced in the input file S3 URL.</p>
</li>
<li>
<p>The <code>-U</code> option has been specified.
If all three of the above are true then <code>get_dmrpp</code> will copy the retrieve the granule, create a DMR++ file from the granule, and copy the resulting DMR++ file (as defined by the <code>-o</code> option) to the source S3 bucket using the well-known NGAP sidecar file naming convention: <strong>s3://bucket_name/granule_object_id.dmrpp</strong>.  For example:</p>
<div class="literalblock">
<div class="content">
<pre class="nowrap">get_dmrpp -U -o foo -b `pwd` s3://bucket_name/granule_object_id</pre>
</div>
</div>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_hdf5_handler_configuration">C.3. <em>HDF5_handler</em> Configuration</h3>
<div class="paragraph">
<p>Because <em>get_dmrpp</em> uses the <em>HDF5_handler</em> software to build the DMR++ the software must inject the <em>HDF5_handler</em>'s configuration.</p>
</div>
<div class="paragraph">
<p>The default configuration is large, but any valued may be altered at runtime.</p>
</div>
<div class="paragraph">
<p>Here are some of the commonly manipulated configuration parameters with their default values:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"> H5.EnableCF=false
 H5.EnableDMR64bitInt=true
 H5.DefaultHandleDimension=true
 H5.KeepVarLeadingUnderscore=false
 H5.EnableCheckNameClashing=true
 H5.EnableAddPathAttrs=true
 H5.EnableDropLongString=true
 H5.DisableStructMetaAttr=true
 H5.EnableFillValueCheck=true
 H5.CheckIgnoreObj=false</pre>
</div>
</div>
<div class="sect3">
<h4 id="_note_to_daacs_with_existing_hyrax_deployments">C.3.1. Note to DAACs with existing Hyrax deployments.</h4>
<div class="paragraph">
<p>If your group is already serving data with Hyrax and the data representations that are generated by your Hyrax server are satisfactory, then a careful inspection of the localized configuration, typically held in <code>/etc/bes/site.conf</code>, will help you determine what configuration state you may need to inject into <em>get_dmrpp</em>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_the_h5_enablecf_option">C.4. The <em>H5.EnableCF</em> option</h3>
<div class="paragraph">
<p>Of particular importance is the <em>H5.EnableCF</em> option, which instructs the <em>get_dmrpp</em> tool to produce <a href="https://cfconventions.org/">Climate Forecast convention (CF)</a> compatible output based on metadata found in the granule file being processed.</p>
</div>
<div class="paragraph">
<p>Changing the value of <em>H5.EnableCF</em> from <strong>false</strong> to <strong>true</strong> will have (at least) two significant effects.</p>
</div>
<div class="paragraph">
<p>It will:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Cause <em>get_dmrpp</em> to attempt to make the dmr++ metadata CF compliant.</p>
</li>
<li>
<p>Remove Group hierarchies (if any) in the underlying data granule by flattening the Group hierarchy into the variable names.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>By default <em>get_dmrpp</em> the <em>H5.EnableCF</em> option is set to false:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="nowrap"> H5.EnableCF = false</pre>
</div>
</div>
<div class="paragraph">
<p>There is a much more comprehensive discussion of this key feature, and others, in the <a href="https://opendap.github.io/hyrax_guide/Master_Hyrax_Guide.html#HDF5-handler">HDF5 Handler section</a> of the Appendix in the Hyrax Data Server Installation and Configuration Guide.</p>
</div>
</div>
<div class="sect2">
<h3 id="_missing_data_the_cf_conventions_and_hdf5">C.5. Missing data, the CF conventions and <em>HDF5</em></h3>
<div class="paragraph">
<p>Many of the <em>HDF5</em> files produced by NASA and others do not contain the domain coordinate data (such as latitude, longitude, time, etc.) as a collection of explicit values. Instead, information contained in the dataset metadata can be used to reproduce these values.</p>
</div>
<div class="paragraph">
<p>In order for a dataset to be Climate Forecast (CF) compatible, it must contain these domain coordinate data values.</p>
</div>
<div class="paragraph">
<p>The Hyrax <em>HDF5_handler</em> software, used by the <em>get_dmrpp</em> application, can create this data from the dataset metadata.  The <em>get_dmrpp</em> application places these generated data in a sidecar file for deployment with the source <em>HDF5/netcdf-4</em> file.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footnotes">
<hr>
<div class="footnote" id="_footnotedef_1">
<a href="#_footnoteref_1">1</a>. The HTTP/S service must support the <em>Range</em> header of HTTP/1.1. When using libcurl, both HTTP/S and the 'file:' protocols can be used.
</div>
<div class="footnote" id="_footnotedef_2">
<a href="#_footnoteref_2">2</a>. The netCDF4 format is a subset of HDF5, so HDF5 tools are used for both.
</div>
<div class="footnote" id="_footnotedef_3">
<a href="#_footnoteref_3">3</a>. Not supporting netCDF3 is a shame because it&#8217;s commonly found in older collections of data, and it&#8217;s one of the simpler data formats.
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-10-31 21:25:03 UTC
</div>
</div>
</body>
</html>