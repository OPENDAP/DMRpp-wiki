sudo: required

# whitelist
branches:
  only:
    - main

notifications:
  email:
    - mjimenez@opendap.org
env:
  global:
    # GIT_UID
    - secure: "mdJZfmb5eoyoRVkd7wJBKwHH1glNfLm6VHUKPzIByw+0W6xf1Ru9BiYPgI/s6LdGSy5w3ggwjWjWzJjrnOdjNqOSTgpfd5JibgRRmW/s047i1p7j+mxKXWdkzAUtB0rCycE4pqRL6G7RRMLMtbb9QwVfdCVrWLVT9K/VooM240BZ2fjnWngJ8Tm9hpZsUuHMGgZ4xWjnK8zahIcb4u2p0B5QEwgLQH/eDyIFrP12VO2ffFBYSBQy/0De7r1E60zpzuZVrLsVwkY5NHh/MkV9MS12qzGatvMVlSLhzLPk7cjj4BP10uyNun5+w9jYkz/zQ7sd3Ukta++KHmxQnRVSkNbN9xCnX5uNwi6/TP3MysiSB3mr4KJQxGQzo4cuci5+RaUalvntAkZrzpNBapxTJi6Oa2fCi4wtvhj7cWVPxLVySNRKp+cYCxkW7W0ILMpDlnptxYx8Gx4YJNIJDORFGeKRb8fdQCjQw+AQWy/bacDsnWb6sAYwb8/asMDygk3M3gLr2lRLwjaax4M3zgvrxS0aErCthmfYKxXzr3uWbwddbJPF3FsVWEBbcJ5/VihG6p1F+ASLuM0zmZWvqrGgvLGe6oj2Y1bKwG8WL+JZqFIPdwF0oK5ddk0iQNLQlNM051yWrK2kmYxMX24saYROJtyQLZUrmiMHDgnWK+3eT20="
    # GIT_TOKEN
    - secure: "Ee8x6gPumMFPBTlxDb0NlmkI+kRDMYU9C/3G/dNlrcnk8Mq38NV4cuTZNIetcuQ3KSHVPTAww8bvoNsi5wc5vUIov9nXq+DIe4hQk9CTPyzhq89gU0WyEuYuuodmLjxu6BJbmR+u8JrI4f+qj1oYWuEN7HW38IUOcq18oCppxPG3Y0QlMQ6AKF3lDcXk2zT1hT9y8v8rToFS7wFPJ1rqJI7qmtBCiiV0QwVHAmCH0ZL5pHxWASl4ZTGHoYT9WmGuCb2W1HL+/HET8rwUsnexHWjYzCDUdKDr2cnevO1b1R+OKIPe+GC+2mcQYjybndkdxADS6MZODwujfFFKcTp/3T+H8O0+sZBJfvhdb+WAYJMUe3OC9ywVCn/75dHqYCHnxcMz6gwd8Ks9aeq7d34Po0HTsXxmvExHH8ar0d5uHXjYTcWF2WV3hVtlOJamnbLSLfgCU6qmZ2bW3XzO0+aOJjxHo0H8+3txKQebXEBV/DLdmkvS+DLwjhX86yMY7E1G8iqyLDAtQBMzIoDH/BTti26T1InFX6HjuVUa0kazEMrGUmBFqK5EMTkXIbQ9UR7pBwfLoU6ayJZ51le5+fdOYda/CswHteMFz4j8h3u5TzZCQ/jFNaeqYMIbY4nOal54hhm07uCjlRwIHaZ4XypPHJIeTTckmHoyq5pj9K1lrAg="

services:
  - docker                  

before_install:
  - mkdir -p output
  - docker pull asciidoctor/docker-asciidoctor

# Name the file explicitly until we sort out the organization of the 'documentation'
# project.

script:
  # Inject the version information
  - GUIDE_VERSION=`cat VERSION`"-${TRAVIS_BUILD_NUMBER}"
  - echo ${GUIDE_VERSION}
  - docker run -v $TRAVIS_BUILD_DIR:/documents/ --name asciidoc-to-html asciidoctor/docker-asciidoctor      asciidoctor -D /documents/output DMRpp.adoc
  - docker run -v $TRAVIS_BUILD_DIR:/documents/ --name  asciidoc-to-pdf asciidoctor/docker-asciidoctor  asciidoctor-pdf -D /documents/output DMRpp.adoc

after_error: 
  - docker logs asciidoc-to-html
  - docker logs asciidoc-to-pdf

after_failure:
  - docker logs asciidoc-to-html
  - docker logs asciidoc-to-pdf


after_success:      
  - ./travis/deploy_to_gh_pages.sh